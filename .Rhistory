curvature = .1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 6, yend = 30,
curvature = -.1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 3, yend = 40,
curvature = -.3, arrow = arrow(length = unit(2, "mm")))+
labs(x="",y="Number of extinct species",title="Which are the biggest threads?")
large
large <- threats %>%
group_by(threat_type) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=threat_type,y=n_species))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)+
annotate("text",x=9,y=165,
label="As these threats have \nfew cases each, we \nmove them to Category 'Other'")+
annotate(geom = "curve", x = 10.1, y = 170, xend = 10.5, yend = 20,
curvature = .1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 6, yend = 50,
curvature = -.1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 3, yend = 40,
curvature = -.3, arrow = arrow(length = unit(2, "mm")))+
labs(x="",y="Number of extinct species",title="Which are the biggest threads?")
large
plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),fill=..count..))+
geom_bar()+
scale_fill_hp(option="NewtScamander")
plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()
plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()+
labs(x="Last year the species was seen",y="Number of species")
plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()+
labs(x="Last year the species was seen",y="Number of extinct species")+
theme(axis.text.x=element_text(angle=30))
plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()+
labs(x="Last year the species was seen",y="Number of extinct species")+
theme(axis.text.x=element_text(angle=20))
years <- plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()+
labs(x="Last year the species was seen",y="Number of extinct species")+
theme(axis.text.x=element_text(angle=20))
facets <- threats %>%
filter(!is.na(year_last_seen),
continent%in%c("Africa","North America","South America")) %>%
mutate(threat_type=gsub(paste0(low_freq,collapse="|"),"Other",threat_type)) %>%
group_by(continent,threat_type,year_last_seen) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),y=n_species))+
geom_col(fill="goldenrod3")+
facet_grid(continent~threat_type)+
gghighlight(n_species>10,calculate_per_facet = T)+
labs(x="Last year the species was seen (Before 1900 - 2020)",y="")+
theme(axis.text=element_blank())
library(patchwork)
(large / years)+facets
facets+large/years
large/years+facets
(large/years)|facets
(large/years)|facets+plot_spacer(c(2,3))
?plot_spacer
patchwork::plot_layout()
?patchwork::plot_layout
(large/years)|facets+plot_layout(widths=c(2,3))
(large/years)|facets+plot_layout(widths=c(2,2,3))
(large/years)|facets + plot_layout(design=layout)
layout <- "
##AAAA
BBCCCC
"
(large/years)|facets + plot_layout(design=layout)
layout <- "
AACCCC
BBCCCC
"
(large/years)|facets + plot_layout(design=layout)
large+years+facets + plot_layout(design=layout)
layout <- "
AACCCC
##CCCC
##BBBB
"
large+years+facets + plot_layout(design=layout)
large/facets/years + plot_layout(ncol=3)
large/facets/years + plot_layout(ncol=1)
(plot_spacer|large) +facets +years + plot_layout(ncol=1)
(plot_spacer + large) +facets +years + plot_layout(ncol=1)
(plot_spacer() + large) +facets +years + plot_layout(ncol=1)
(plot_spacer() | large) +facets +years + plot_layout(ncol=1)
(plot_spacer() | large) +facets +years
(plot_spacer() | large) /facets /years
(plot_spacer() | large) /facets
facets <- threats %>%
filter(!is.na(year_last_seen),
continent%in%c("Africa","North America","South America")) %>%
mutate(threat_type=gsub(paste0(low_freq,collapse="|"),"Other",threat_type)) %>%
group_by(continent,threat_type,year_last_seen) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),y=n_species))+
geom_col(fill="goldenrod3")+
facet_grid(continent~threat_type)+
gghighlight(n_species>10,calculate_per_facet = T)+
labs(x="Last year the species was seen (Before 1900 - 2020)",y="")+
theme(axis.text.x=element_blank())
(plot_spacer() | large) /facets
facets <- threats %>%
filter(!is.na(year_last_seen)) %>%
mutate(threat_type=gsub(paste0(low_freq,collapse="|"),"Other",threat_type)) %>%
group_by(continent,threat_type,year_last_seen) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),y=n_species))+
geom_col(fill="goldenrod3")+
facet_grid(continent~threat_type)+
gghighlight(n_species>10,calculate_per_facet = T)+
labs(x="Last year the species was seen (Before 1900 - 2020)",y="")+
theme(axis.text.x=element_blank())
(plot_spacer() | large) /facets + plot_annotation(
title = 'Plants in danger - Threads in different continents',
subtitle = 'These 3 plots will reveal yet-untold secrets about our beloved data-set',
caption = 'Disclaimer: None of these plots are insightful'
)
facets <- threats %>%
filter(!is.na(year_last_seen),
continent%in%c('Africa','North America','South America')) %>%
mutate(threat_type=gsub(paste0(low_freq,collapse="|"),"Other",threat_type)) %>%
group_by(continent,threat_type,year_last_seen) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),y=n_species))+
geom_col(fill="goldenrod3")+
facet_grid(continent~threat_type)+
gghighlight(n_species>10,calculate_per_facet = T)+
labs(x="Last year the species was seen (Before 1900 - 2020)",y="")+
theme(axis.text.x=element_blank())
continents <- threats %>%
group_by(continent) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=threat_type,y=n_species))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)+
#Per year
years <- plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()+
labs(x="Last year the species was seen",y="Number of extinct species")+
theme(axis.text.x=element_text(angle=20))
continents <- threats %>%
group_by(continent) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=threat_type,y=n_species))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)
continents
continents <- threats %>%
group_by(continent) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=continent,y=n_species))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)
continent
continents
continents <- plants %>%
group_by(continent) %>%
count() %>%
ggplot(aes(x=continent,y=n))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)
continents <- plants %>%
group_by(continent) %>%
count() %>%
ggplot(aes(x=continent,y=n))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)
plants %>%
group_by(continent) %>%
count()
continents <- plants %>%
group_by(continent) %>%
count() %>%
ggplot(aes(x=continent,y=n))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n>60)
continents
continents <- plants %>%
group_by(continent) %>%
count() %>%
ggplot(aes(x=continent,y=n))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n>60)+
labs(x="",y="Number of extinct species",title="Which are the biggest threads?")
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Threads in different continents',
subtitle = 'In the histor',
)
continents <- plants %>%
group_by(continent) %>%
count() %>%
ggplot(aes(x=continent,y=n))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n>60)+
labs(x="",y="Number of extinct species",title="Which are the most affected continents?")
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Threats in different continents',
subtitle = 'South America - most species',
)
(continents| large) /facets + plot_annotation(
)
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Threats in different continents',
subtitle = 'South America - most species were extinct before 1900.\n
Africa - most species were extinct between 1900-1960\n
North America - most species were extinct in the last 40 years.'
)
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Threats in different continents',
subtitle = 'South America - most species were extinct before 1900.\nAfrica - most species were extinct between 1900-1960\nNorth America - most species were extinct in the last 40 years.'
)
large <- threats %>%
group_by(threat_type) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=threat_type,y=n_species))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)+
annotate("text",x=9,y=165,
label="As these threats have \nfew cases each, we \nmove them to Category 'Other'")+
annotate(geom = "curve", x = 10.1, y = 170, xend = 10.5, yend = 20,
curvature = .1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 6, yend = 50,
curvature = -.1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 3, yend = 40,
curvature = -.3, arrow = arrow(length = unit(2, "mm")))+
labs(x="",y="Number of extinct species (double count possible)",title="Which are the biggest threads?")
low_freq <- threats %>% group_by(threat_type) %>%
summarise(n=sum(threatened)) %>%
filter(n<50) %>% .$threat_type
continents <- plants %>%
group_by(continent) %>%
count() %>%
ggplot(aes(x=continent,y=n))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n>60)+
labs(x="",y="Number of extinct species",title="Which are the most affected continents?")
years <- plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()+
labs(x="Last year the species was seen",y="Number of extinct species")+
theme(axis.text.x=element_text(angle=20))
facets <- threats %>%
filter(!is.na(year_last_seen),
continent%in%c('Africa','North America','South America')) %>%
mutate(threat_type=gsub(paste0(low_freq,collapse="|"),"Other",threat_type)) %>%
group_by(continent,threat_type,year_last_seen) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),y=n_species))+
geom_col(fill="goldenrod3")+
facet_grid(continent~threat_type)+
gghighlight(n_species>10,calculate_per_facet = T)+
labs(x="Last year the species was seen (Before 1900 - 2020)",y="")+
theme(axis.text.x=element_blank())
library(patchwork)
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Threats in different continents',
subtitle = 'South America - most species were extinct before 1900.\nAfrica - most species were extinct between 1900-1960\nNorth America - most species were extinct in the last 40 years.'
)
large <- threats %>%
group_by(threat_type) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=threat_type,y=n_species))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)+
annotate("text",x=9,y=165,
label="As these threats have \nfew cases each, we \nmove them to Category 'Other'")+
annotate(geom = "curve", x = 10.1, y = 170, xend = 10.5, yend = 20,
curvature = .1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 6, yend = 50,
curvature = -.1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 3, yend = 40,
curvature = -.3, arrow = arrow(length = unit(2, "mm")))+
labs(x="",y="Number of extinct species (double count possible)",title="Which are the biggest threats?")
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Threats in different continents',
subtitle = 'South America - most species were extinct before 1900.\nAfrica - most species were extinct between 1900-1960\nNorth America - most species were extinct in the last 40 years.'
)
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Different threats in different continent and times',
subtitle = 'South America - most species were extinct before 1900.\nAfrica - most species were extinct between 1900-1960\nNorth America - most species were extinct in the last 40 years.'
)
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Different threats in different continents and times',
subtitle = 'South America - most species were extinct before 1900.\nAfrica - most species were extinct between 1900-1960\nNorth America - most species were extinct in the last 40 years.'
)
facets <- threats %>%
filter(!is.na(year_last_seen),
continent%in%c('Africa','North America','South America')) %>%
mutate(threat_type=gsub(paste0(low_freq,collapse="|"),"Other",threat_type)) %>%
group_by(continent,threat_type,year_last_seen) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),y=n_species))+
geom_col(fill="goldenrod3")+
facet_grid(continent~threat_type)+
gghighlight(n_species>10,calculate_per_facet = T)+
labs(x="Last year the species was seen (Before 1900 - 2020)",y="")+
theme(axis.text.x=element_text(angle=90))
library(ggplot2)
library(dplyr)
library(forcats)
library(gghighlight)
tuesdata <- tidytuesdayR::tt_load('2020-08-18')
plants <- tuesdata$plants
threats <- tuesdata$threats
actions <- tuesdata$actions
large <- threats %>%
group_by(threat_type) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=threat_type,y=n_species))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n_species>50)+
annotate("text",x=9,y=165,
label="As these threats have \nfew cases each, we \nmove them to Category 'Other'")+
annotate(geom = "curve", x = 10.1, y = 170, xend = 10.5, yend = 20,
curvature = .1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 6, yend = 50,
curvature = -.1, arrow = arrow(length = unit(2, "mm")))+
annotate(geom = "curve", x = 7.5, y = 170, xend = 3, yend = 40,
curvature = -.3, arrow = arrow(length = unit(2, "mm")))+
labs(x="",y="Number of extinct species (double count possible)",title="Which are the biggest threats?")
low_freq <- threats %>% group_by(threat_type) %>%
summarise(n=sum(threatened)) %>%
filter(n<50) %>% .$threat_type
continents <- plants %>%
group_by(continent) %>%
count() %>%
ggplot(aes(x=continent,y=n))+
geom_bar(stat="identity",fill="goldenrod3")+
coord_flip()+
gghighlight(n>60)+
labs(x="",y="Number of extinct species",title="Which are the most affected continents?")
years <- plants %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900")))+
geom_bar()+
labs(x="Last year the species was seen",y="Number of extinct species")+
theme(axis.text.x=element_text(angle=20))
facets <- threats %>%
filter(!is.na(year_last_seen),
continent%in%c('Africa','North America','South America')) %>%
mutate(threat_type=gsub(paste0(low_freq,collapse="|"),"Other",threat_type)) %>%
group_by(continent,threat_type,year_last_seen) %>%
summarise(n_species=sum(threatened)) %>%
ggplot(aes(x=fct_relevel(year_last_seen,"Before 1900"),y=n_species))+
geom_col(fill="goldenrod3")+
facet_grid(continent~threat_type)+
gghighlight(n_species>10,calculate_per_facet = T)+
labs(x="Last year the species was seen (Before 1900 - 2020)",y="")+
theme(axis.text.x=element_text(angle=90))
library(patchwork)
(continents| large) /facets + plot_annotation(
title = 'Plants in danger - Different threats in different continents and times',
subtitle = 'South America - most species were extinct before 1900.\nAfrica - most species were extinct between 1900-1960\nNorth America - most species were extinct in the last 40 years.'
)
tuesdata <- tidytuesdayR::tt_load('2020-08-18')
plants <- tuesdata$plants
threats <- tuesdata$threats
actions <- tuesdata$actions
library(ggplot2)
library(dplyr)
library(forcats)
library(gghighlight)
View(plants)
install.packages("tmap")
library(tmap)
tm_shape(nz)+tm_fill()
?tm_shape
data(World, metro, rivers)
tm_shape(rivers)+tm_fill()
tm_shape(rivers)+tm_borders()
tm_shape(rivers)
tm_shape(rivers)+tm_lines()
tm_shape(rivers)+tm_lines(col="blue")
library(ggplot)
library(ggplot2)
ggplot()+geom_sf(data=rivers)
#Option 3
plot(rivers)
tm_shape(World,projection=4326)+tm_polygons()
tm_shape(World,projection=4326,simplify=0.5)+tm_polygons()
tm_shape(World,projection=4326)+tm_polygons()+tm_shape(rivers)+tm_lines(col="blue")
tm_shape(World,projection=4326)+tm_polygons()+tm_shape(rivers,projection=4326)+tm_lines(col="blue")
ggplot(data=World)+
geom_sf()+
geom_sf(data=rivers)
ggplot(data=World)+
geom_sf()+
geom_sf(data=rivers,col="blue")
View(World)
tm_shape(World,projection=4326)+tm_fill(fill=income_grp)
tm_shape(World,projection=4326)+tm_fill(fill=World$income_grp)
tm_shape(World,projection=4326)+tm_fill(fill="income_grp")
tm_shape(World,projection=4326)+tm_fill(col="income_grp")
tm_shape(World,projection=4326)+
tm_polygons()+
tm_fill(col="income_grp")
tm_shape(World,projection=4326)+
tm_fill(col="income_grp")+
tm_polygons()
tm_shape(World,projection=4326)+
tm_polygons()+
tm_shape(rivers,projection=4326)+
tm_lines(col="blue")
tm_shape(World,projection=4326)+
tm_fill(col="income_grp")+
tm_polygons()
tm_shape(World,projection=4326)+
tm_fill(col="income_grp",palette="BuGn")+
tm_polygons()
tm_shape(World,projection=4326)+
tm_polygons(col="income_grp",palette="BuGn")
tm_shape(World,projection=4326)+
tm_polygons()+
tm_shape(rivers,projection=4326)+
tm_lines(col="blue")
tm_shape(World)+
tm_polygons(col="life_exp",n=5)
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",n=5)
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",n=6)
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",breaks=c(0,50,60,70,100))
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",breaks=c(0,50,60,70,80,100))
#World and Rivers data in one plot
tm_shape(World,projection=4326)+
tm_polygons()+
tm_shape(rivers)+
tm_lines(col="blue")
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",style="pretty")
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",style="equal")
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",style="cont")
#Projection 4326 looks much better than the default
#Color by income grp, using a different color palette
tm_shape(World,projection=4326)+
tm_polygons(col="income_grp",palette="YlOrBr")
#Projection 4326 looks much better than the default
#Color by income grp, using a different color palette
tm_shape(World,projection=4326)+
tm_polygons(col="income_grp",palette="RdOrBr")
#Projection 4326 looks much better than the default
#Color by income grp, using a different color palette
tm_shape(World,projection=4326)+
tm_polygons(col="income_grp",palette="ReOrBr")
#Projection 4326 looks much better than the default
#Color by income grp, using a different color palette
tm_shape(World,projection=4326)+
tm_polygons(col="income_grp",palette="BuGn")
#Or try styles: cont, jenks, pretty, equal, quantile
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",style="cont")+
tm_scale_bar()
#Or try styles: cont, jenks, pretty, equal, quantile
#And add a scale_bar and compass
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",style="cont")+
tm_scale_bar()+
tm_compass()
#Or try styles: cont, jenks, pretty, equal, quantile
#And add a scale_bar and compass
tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",style="cont")+
tm_compass()
#Or try styles: cont, jenks, pretty, equal, quantile
life_exp_map <- tm_shape(World,projection=4326)+
tm_polygons(col="life_exp",style="cont")
life_exp_map
#Add compass
life_exp_map+tm_compass()
#styles
life_exp_map+tm_style("cobalt")
#styles
life_exp_map+tm_style("bw")
life_exp_map+tm_style("classic")
life_exp_map+tm_style("cobalt")
life_exp_map+tm_style("col_blind")
?tm_stlye
?tm_style
#styles
life_exp_map+tm_style("albatross")
#styles
life_exp_map+tm_style("beaver")
#styles
life_exp_map+tm_style("bw")
